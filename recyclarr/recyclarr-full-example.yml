# yaml-language-server: $schema=https://raw.githubusercontent.com/recyclarr/recyclarr/master/schemas/config-schema.json

# Langarr - Recyclarr Configuration with Dual Profile Strategy
# Documentation: https://recyclarr.dev
#
# ⚠️  CONFIGURED FOR GERMAN DUBS
# This uses TRaSH Guide's German-specific custom formats.
# To adapt for French/Spanish/etc., see README.md "Adapting for Other Languages"
#
# This configuration creates TWO quality profiles:
# 1. "Original Preferred" - For content in your native languages (keeps original audio)
# 2. "Dub Preferred" - For foreign content (prefers dub, accepts original as fallback)
#
# The langarr-tagger container auto-assigns profiles based on original language

###################################################################################################
# Radarr Configuration
###################################################################################################

radarr:
  movies:
    # IMPORTANT: Replace with your actual Radarr URL and API key
    base_url: !env_var RADARR_URL
    api_key: !env_var RADARR_API_KEY
    delete_old_custom_formats: true
    replace_existing_custom_formats: true
    
    # Include quality definitions and German custom formats from TRaSH Guides
    include:
      - template: radarr-quality-definition-movie
      - template: radarr-custom-formats-hd-bluray-web-german

    # Quality Definition - Configure preferred quality ratio
    quality_definition:
      type: movie
      preferred_ratio: 0.5  # Preferred quality at 50% between min and max

    # Media Naming - Standardize movie file and folder names (Plex with IMDB ID)
    media_naming:
      folder: plex-imdb  # {Movie CleanTitle} ({Release Year}) {imdb-{ImdbId}}
      movie:
        rename: true
        standard: plex-imdb  # Includes IMDB ID, Edition Tags, Custom Formats, Quality, Audio, HDR, Codec, Release Group

    # Custom Formats - defined at service level and assigned to profiles
    custom_formats:
      # GERMAN DL - HIGHEST (has both tracks)
      - trash_ids:
          - f845be10da4f442654c13e1f2c3d6cd5  # German DL
        assign_scores_to:
          - name: Original Preferred
            score: 15000
          - name: Dub Preferred
            score: 15000
      
      - trash_ids:
          - 6aad77771dabe9d3e9d7be86f310b867  # German DL (undefined)
        assign_scores_to:
          - name: Original Preferred
            score: 15000
          - name: Dub Preferred
            score: 15000

      # ORIGINAL RELEASES - Tiered scoring
      - trash_ids:
          - ed27ebfef2f323e964fb1f61391bcb35  # HD Bluray Tier 01
        assign_scores_to:
          - name: Original Preferred
            score: 10000
          - name: Dub Preferred
            score: 10000

      - trash_ids:
          - c20c8647f2746a1f4c4262b0fbbeeeae  # HD Bluray Tier 02
        assign_scores_to:
          - name: Original Preferred
            score: 9500
          - name: Dub Preferred
            score: 9500

      - trash_ids:
          - 5608c71bcebba0a5e666223bae8c9227  # HD Bluray Tier 03
        assign_scores_to:
          - name: Original Preferred
            score: 9000
          - name: Dub Preferred
            score: 9000

      - trash_ids:
          - c20f169ef63c5f40c2def54abaf4438e  # WEB Tier 01
        assign_scores_to:
          - name: Original Preferred
            score: 8500
          - name: Dub Preferred
            score: 8500

      - trash_ids:
          - 403816d65392c79236dcb6dd591aeda4  # WEB Tier 02
        assign_scores_to:
          - name: Original Preferred
            score: 8000
          - name: Dub Preferred
            score: 8000

      - trash_ids:
          - af94e0fe497124d1f9ce732069ec8c3b  # WEB Tier 03
        assign_scores_to:
          - name: Original Preferred
            score: 7500
          - name: Dub Preferred
            score: 7500

      # GERMAN ONLY - Different scoring per profile
      - trash_ids:
          - 86bc3115eb4e9873ac96904a4a68e19e  # German
        assign_scores_to:
          - name: Original Preferred
            score: 3000  # LOW - loses original track
          - name: Dub Preferred
            score: 11000  # HIGH - preferred for foreign content

      # German Quality Tiers (uses default from german score_set)
      - trash_ids:
          - 54795711b78ea87e56127928c423689b  # German Bluray Tier 01
          - 1bfc773c53283d47c68e535811da30b7  # German Bluray Tier 02
          - aee01d40cd1bf4bcded81ee62f0f3659  # German Bluray Tier 03
          - a2ab25194f463f057a5559c03c84a3df  # German Web Tier 01
          - 08d120d5a003ec4954b5b255c0691d79  # German Web Tier 02
          - 439f9d71becaed589058ec949e037ff3  # German Web Tier 03
          - 2d136d4e33082fe573d06b1f237c40dd  # German Scene
        assign_scores_to:
          - name: Original Preferred
          - name: Dub Preferred

      # Resolution Boosters (uses default from german score_set)
      - trash_ids:
          - 3bc8df3a71baaac60a31ef696ea72d36  # German 1080p Booster
          - 820b09bb9acbfde9c35c71e0e565dad8  # 1080p
          - b2be17d608fc88818940cd1833b0b24c  # 720p
        assign_scores_to:
          - name: Original Preferred
          - name: Dub Preferred

      # Movie Versions
      - trash_ids:
          - 0f12c086e289cf966fa5948eac571f44  # Criterion Collection
          - e0c07d59beb37348e975a930d5e50319  # Masters of Cinema
          - 09d9dd29a0fc958f9796e65c2a8864b4  # Special Edition
          - 957d0f44b592285f26449575e8b1167e  # IMAX Enhanced
          - eecf3a857724171f968a66cb5719e152  # IMAX
          - eca37840c13c6ef2dd0262b141a5482f  # 4K Remaster
        assign_scores_to:
          - name: Original Preferred
          - name: Dub Preferred

      # Hybrid (Block)
      - trash_ids:
          - 570bc9ebecd92723d2d21500f4be314c  # Hybrid
        assign_scores_to:
          - name: Original Preferred
            score: -10000
          - name: Dub Preferred
            score: -10000

      # HDR Formats
      - trash_ids:
          - 493b6d1dbec3c3364c59d7607f7e3405  # HDR
        assign_scores_to:
          - name: Original Preferred
            score: 100
          - name: Dub Preferred
            score: 100

      - trash_ids:
          - b337d6812e06c200ec9a2d3cfa9d20a7  # DV Boost
        assign_scores_to:
          - name: Original Preferred
            score: 150
          - name: Dub Preferred
            score: 150

      - trash_ids:
          - caa37d0df9c348912df1fb1d88f9273a  # HDR10+ Boost
        assign_scores_to:
          - name: Original Preferred
            score: 75
          - name: Dub Preferred
            score: 75

      # Streaming Services (for visibility)
      - trash_ids:
          - b3b3a6ac74ecbd56bcdbefa4799fb9df  # AMZN
          - 40e9380490e748672c2522eaaeb692f7  # ATVP
          - cc5e51a9e85a6296ceefe097a77f12f4  # DSNP
          - 84272245b2988854bfb76a16e60baea5  # HMAX
          - 509e5f41146e278f9eab1ddaceb34515  # NF
          - 5763d1b0ce84aff3b21038eea8e9b8ad  # PMTP
          - fb3ccc5d5cc8f77c9055d4cb4561dded  # PCOK
        assign_scores_to:
          - name: Original Preferred
            score: 0
          - name: Dub Preferred
            score: 0

      # Audio Boosters - Progressive scoring for superior audio codecs
      - trash_ids:
          - 496f355514737f7d83bf7aa4d24f8169  # TrueHD Atmos
        assign_scores_to:
          - name: Original Preferred
            score: 500
          - name: Dub Preferred
            score: 500

      - trash_ids:
          - 2f22d89048b01681dde8afe203bf2e95  # DTS X
        assign_scores_to:
          - name: Original Preferred
            score: 480
          - name: Dub Preferred
            score: 480

      - trash_ids:
          - 417804f7f2c4308c1f4c5d380d4c4475  # Atmos (undefined)
        assign_scores_to:
          - name: Original Preferred
            score: 460
          - name: Dub Preferred
            score: 460

      - trash_ids:
          - 1af239278386be2919e1bcee0bde047e  # DD+ Atmos
        assign_scores_to:
          - name: Original Preferred
            score: 440
          - name: Dub Preferred
            score: 440

      - trash_ids:
          - 3cafb66171b47f226146a0770576870f  # TrueHD
        assign_scores_to:
          - name: Original Preferred
            score: 400
          - name: Dub Preferred
            score: 400

      - trash_ids:
          - dcf3ec6938fa32445f590a4da84256cd  # DTS-HD MA
        assign_scores_to:
          - name: Original Preferred
            score: 380
          - name: Dub Preferred
            score: 380

      - trash_ids:
          - 8e109e50e0a0b83a5098b056e13bf6db  # DTS-HD HRA
        assign_scores_to:
          - name: Original Preferred
            score: 350
          - name: Dub Preferred
            score: 350

      - trash_ids:
          - a570d4a0e56a2874b64e5bfa55202a1b  # FLAC
        assign_scores_to:
          - name: Original Preferred
            score: 360
          - name: Dub Preferred
            score: 360

      - trash_ids:
          - e7c2fcae07cbada050a0af3357491d7b  # PCM
        assign_scores_to:
          - name: Original Preferred
            score: 340
          - name: Dub Preferred
            score: 340

      - trash_ids:
          - 185f1dd7264c4562b9022d963ac37424  # DD+
        assign_scores_to:
          - name: Original Preferred
            score: 250
          - name: Dub Preferred
            score: 250

      - trash_ids:
          - f9f847ac70a0af62ea4a08280b859636  # DTS-ES
        assign_scores_to:
          - name: Original Preferred
            score: 200
          - name: Dub Preferred
            score: 200

      - trash_ids:
          - 1c1a4c5e823891c75bc50380a6866f73  # DTS
        assign_scores_to:
          - name: Original Preferred
            score: 150
          - name: Dub Preferred
            score: 150

      - trash_ids:
          - 240770601cc226190c367ef59aba7463  # AAC
        assign_scores_to:
          - name: Original Preferred
            score: 100
          - name: Dub Preferred
            score: 100

      - trash_ids:
          - c2998bd0d90ed5621d8df281e839436e  # DD
        assign_scores_to:
          - name: Original Preferred
            score: 50
          - name: Dub Preferred
            score: 50

      # Repack/Proper
      - trash_ids:
          - e7718d7a3ce595f289bfee26adc178f5  # Repack/Proper
        assign_scores_to:
          - name: Original Preferred
            score: 5
          - name: Dub Preferred
            score: 5

      - trash_ids:
          - ae43b294509409a6a13919dedd4764c4  # Repack2
        assign_scores_to:
          - name: Original Preferred
            score: 6
          - name: Dub Preferred
            score: 6

      # Unwanted Quality/Formats
      - trash_ids:
          - ed38b889b31be83fda192888e2286d83  # BR-DISK
          - 90a6f9a284dff5103f6346090e6280c8  # LQ
          - dc98083864ea246d05a42df0d05f81cc  # x265 (HD)
          - 0a3f082873eb454bde444150b70253cc  # Extras
          - bfd8eb01832d646a0a89c4deb46f8564  # Upscaled
          - 03c430f326f10a27a9739b8bc83c30e4  # German Microsized
          - b8cd450cbfa689c0259a01d9e29ba3d6  # AV1
          - 839bea857ed2c0a8e084f3cbdbd65ecb  # x265 (no HDR/DV)
          - 923b6abef9b17f937fab56cfcf89e1f1  # DV (WEBDL)
        assign_scores_to:
          - name: Original Preferred
            score: -10000
          - name: Dub Preferred
            score: -10000

      # Unwanted - Strong Blockers
      - trash_ids:
          - 4eadb75fb23d09dfc0a8e3f687e72287  # Not German or English
        assign_scores_to:
          - name: Original Preferred
            score: -50000  # Block foreign audio on EN/DE content
          - name: Dub Preferred
            score: 0  # Neutral - allow original as fallback, prefer German dub when available

    quality_profiles:
      # PROFILE 1: Original Preferred (for native language content)
      # Dual-language (DL) best, then original, then dub as last resort
      - name: Original Preferred
        reset_unmatched_scores:
          enabled: true
        score_set: german  # Use German score set as baseline
        upgrade:
          allowed: true
          until_quality: Merged QPs
          until_score: 50000
        min_format_score: 0
        quality_sort: top
        qualities:
          - name: Merged QPs
            qualities:
              - Bluray-1080p
              - WEBRip-1080p
              - WEBDL-1080p
              - Bluray-720p
              - WEBDL-720p
              - WEBRip-720p

      # PROFILE 2: Dub Preferred (for foreign content)
      # Dual-language (DL) best, then dub, then original as fallback
      - name: Dub Preferred
        reset_unmatched_scores:
          enabled: true
        score_set: german
        upgrade:
          allowed: true
          until_quality: Merged QPs
          until_score: 50000
        min_format_score: 0
        quality_sort: top
        qualities:
          - name: Merged QPs
            qualities:
              - Bluray-1080p
              - WEBRip-1080p
              - WEBDL-1080p
              - Bluray-720p
              - WEBDL-720p
              - WEBRip-720p

###################################################################################################
# Sonarr Configuration
###################################################################################################

sonarr:
  tv:
    # IMPORTANT: Replace with your actual Sonarr URL and API key
    base_url: !env_var SONARR_URL
    api_key: !env_var SONARR_API_KEY
    delete_old_custom_formats: true
    replace_existing_custom_formats: true

    # Include quality definitions and German custom formats from TRaSH Guides
    include:
      - template: sonarr-quality-definition-series
      - template: sonarr-v4-custom-formats-hd-bluray-web-german

    # Quality Definition - Configure preferred quality ratio
    quality_definition:
      type: series
      preferred_ratio: 0.5  # Preferred quality at 50% between min and max

    # Media Naming - Standardize series/episode file and folder names (Plex with IMDB ID)
    media_naming:
      series: plex-imdb  # {Series TitleYear} {imdb-{ImdbId}}
      season: default    # Season {season:00}
      episodes:
        rename: true
        standard: default  # S##E## format with Custom Formats, Quality, Audio, HDR, Codec, Release Group
        daily: default     # Air-Date format for talk shows/news
        anime: default     # Includes absolute episode number for anime

    # Custom Formats - defined at service level and assigned to profiles
    custom_formats:
      # GERMAN DL - HIGHEST
      - trash_ids:
          - ed51973a811f51985f14e2f6f290e47a  # German DL
        assign_scores_to:
          - name: Original Preferred
            score: 15000
          - name: Dub Preferred
            score: 15000

      - trash_ids:
          - c5dd0fd675f85487ad5bdf97159180bd  # German DL (undefined)
        assign_scores_to:
          - name: Original Preferred
            score: 15000
          - name: Dub Preferred
            score: 15000

      # ORIGINAL RELEASES - Tiered scoring
      - trash_ids:
          - d6819cba26b1a6508138d25fb5e32293  # HD Bluray Tier 01
        assign_scores_to:
          - name: Original Preferred
            score: 10000
          - name: Dub Preferred
            score: 10000

      - trash_ids:
          - c2216b7b8aa545dc1ce8388c618f8d57  # HD Bluray Tier 02
        assign_scores_to:
          - name: Original Preferred
            score: 9500
          - name: Dub Preferred
            score: 9500

      - trash_ids:
          - e6258996055b9fbab7e9cb2f75819294  # WEB Tier 01
        assign_scores_to:
          - name: Original Preferred
            score: 8500
          - name: Dub Preferred
            score: 8500

      - trash_ids:
          - 58790d4e2fdcd9733aa7ae68ba2bb503  # WEB Tier 02
        assign_scores_to:
          - name: Original Preferred
            score: 8000
          - name: Dub Preferred
            score: 8000

      - trash_ids:
          - d84935abd3f8556dcd51d4f27e22d0a6  # WEB Tier 03
        assign_scores_to:
          - name: Original Preferred
            score: 7500
          - name: Dub Preferred
            score: 7500

      # GERMAN ONLY - Different scoring per profile
      - trash_ids:
          - 8a9fcdbb445f2add0505926df3bb7b8a  # German
        assign_scores_to:
          - name: Original Preferred
            score: 3000  # LOW - loses original track
          - name: Dub Preferred
            score: 11000  # HIGH - preferred for foreign content

      # German Quality Tiers (uses default from german score_set)
      - trash_ids:
          - 7940b2fb0278f27cf4f70187f2be95d6  # German Bluray Tier 01
          - 83b336a90d90d6b35ca673b007f80661  # German Bluray Tier 02
          - d8f8e1539827967e0e564833e6c08d33  # German Bluray Tier 03
          - 68be37323132b35cf333c81a2ac8fc16  # German Web Tier 01
          - f51b96a50b0e6196cb69724b7833d837  # German Web Tier 02
          - bda67c2c0aae257308a4723d92475b86  # German Web Tier 03
          - c2eec878fa1989599c226ce4c287d6a7  # German Scene
        assign_scores_to:
          - name: Original Preferred
          - name: Dub Preferred

      # Resolution Boosters (uses default from german score_set)
      - trash_ids:
          - 9aa0ca0d2d66b6f6ee51fc630f46cf6f  # German 1080p Booster
          - 290078c8b266272a5cc8e251b5e2eb0b  # 1080p
          - c99279ee27a154c2f20d1d505cc99e25  # 720p
        assign_scores_to:
          - name: Original Preferred
          - name: Dub Preferred

      # HDR Formats
      - trash_ids:
          - 505d871304820ba7106b693be6fe4a9e  # HDR
        assign_scores_to:
          - name: Original Preferred
            score: 150
          - name: Dub Preferred
            score: 150

      # Streaming Services (for visibility)
      - trash_ids:
          - d660701077794679fd59e8bdf4ce3a29  # AMZN
          - f67c9ca88f463a48346062e8ad07713f  # ATVP
          - 36b72f59f4ea20aad9316f475f2d9fbb  # DSNP
          - 89358767a60cc28783cdc3d0be9388a4  # HMAX
          - 81d1fbf600e2540cee87f3a23f9d3c1c  # NF
          - d34870697c9db575f17700212167be23  # PCOK
        assign_scores_to:
          - name: Original Preferred
            score: 0
          - name: Dub Preferred
            score: 0

      # Audio Boosters - Progressive scoring for superior audio codecs
      - trash_ids:
          - 0d7824bb924701997f874e7ff7d4844a  # TrueHD Atmos
        assign_scores_to:
          - name: Original Preferred
            score: 500
          - name: Dub Preferred
            score: 500

      - trash_ids:
          - 9d00418ba386a083fbf4d58235fc37ef  # DTS X
        assign_scores_to:
          - name: Original Preferred
            score: 480
          - name: Dub Preferred
            score: 480

      - trash_ids:
          - b6fbafa7942952a13e17e2b1152b539a  # Atmos (undefined)
        assign_scores_to:
          - name: Original Preferred
            score: 460
          - name: Dub Preferred
            score: 460

      - trash_ids:
          - 4232a509ce60c4e208d13825b7c06264  # DD+ Atmos
        assign_scores_to:
          - name: Original Preferred
            score: 440
          - name: Dub Preferred
            score: 440

      - trash_ids:
          - c429417a57ea8c41d57e6990a8b0033f  # DTS-HD MA
        assign_scores_to:
          - name: Original Preferred
            score: 380
          - name: Dub Preferred
            score: 380

      - trash_ids:
          - 851bd64e04c9374c51102be3dd9ae4cc  # FLAC
        assign_scores_to:
          - name: Original Preferred
            score: 360
          - name: Dub Preferred
            score: 360

      - trash_ids:
          - 30f70576671ca933adbdcfc736a69718  # PCM
        assign_scores_to:
          - name: Original Preferred
            score: 340
          - name: Dub Preferred
            score: 340

      - trash_ids:
          - 63487786a8b01b7f20dd2bc90dd4a477  # DD+
        assign_scores_to:
          - name: Original Preferred
            score: 250
          - name: Dub Preferred
            score: 250

      # Repack/Proper
      - trash_ids:
          - ec8fa7296b64e8cd390a1600981f3923  # Repack/Proper
        assign_scores_to:
          - name: Original Preferred
            score: 5
          - name: Dub Preferred
            score: 5

      # Unwanted Quality/Formats
      - trash_ids:
          - 32b367365729d530ca1c124a0b180c64  # BR-DISK
          - 9c11cd3f07101cdba90a2d81cf0e56b4  # LQ
          - 23297a736ca77c0fc8e70f8edd7ee56c  # Upscaled
          - 237eda4ef550a97da2c9d87b437e500b  # German Microsized
          - 82d40da2bc6923f41e14394075dd4b03  # No-RlsGroup
          - e1a997ddb54e3ecbfe06341ad323c458  # Obfuscated
          - 06d66ab109d4d2eddb2794d21526d140  # Retags
          - 1b3994c551cbb92a2c781af061f4ab44  # Scene
          - 15a05bc7c1a36e2b57fd628f8977e2fc  # AV1
          - 9b64dff695c2115facf1b6ea59c9bd07  # x265 (no HDR/DV)
          - ef4963043b0987f8485bc9106f16db38  # DV (Disk)
        assign_scores_to:
          - name: Original Preferred
            score: -10000
          - name: Dub Preferred
            score: -10000

      # Unwanted - Strong Blocker
      - trash_ids:
          - 133589380b89f8f8394320901529bac1  # Not German or English
        assign_scores_to:
          - name: Original Preferred
            score: -50000  # Block foreign audio on EN/DE content
          - name: Dub Preferred
            score: 0  # Neutral - allow original as fallback, prefer German dub when available

    quality_profiles:
      # PROFILE 1: Original Preferred (for native language content)
      - name: Original Preferred
        reset_unmatched_scores:
          enabled: true
        score_set: german
        upgrade:
          allowed: true
          until_quality: Merged QPs
          until_score: 50000
        min_format_score: 0
        quality_sort: top
        qualities:
          - name: Merged QPs
            qualities:
              - Bluray-1080p
              - WEBRip-1080p
              - WEBDL-1080p
              - Bluray-720p
              - WEBDL-720p
              - WEBRip-720p

      # PROFILE 2: Dub Preferred (for foreign content)
      - name: Dub Preferred
        reset_unmatched_scores:
          enabled: true
        score_set: german
        upgrade:
          allowed: true
          until_quality: Merged QPs
          until_score: 50000
        min_format_score: 0
        quality_sort: top
        qualities:
          - name: Merged QPs
            qualities:
              - Bluray-1080p
              - WEBRip-1080p
              - WEBDL-1080p
              - Bluray-720p
              - WEBDL-720p
              - WEBRip-720p
